---
title: "【8.2.17】deepcopyによるすべての要素のコピー"
date: 2023-08-05T22:34:03+09:00
tags: [""]
seq: [""]
draft: false
---

- `copy()`関数は、リストの要素がすべてイミュータブルである場合にうまく機能する
  - ミュータブルな値（リスト、集合、辞書）の場合は参照である
    - オリジナルかコピーのどちらかに変更を加えると、両方に変更が反映される

```python
>>> a = [1, 2, [8, 9]]
>>> b = a.copy()
>>> c = list(a)
>>> d = a[:]
>>> a
[1, 2, [8, 9]]
>>> b
[1, 2, [8, 9]]
>>> c
[1, 2, [8, 9]]
>>> d
[1, 2, [8, 9]]
>>> a[2][1] = 10
>>> a
[1, 2, [8, 10]]
>>> b
[1, 2, [8, 10]]
>>> c
[1, 2, [8, 10]]
>>> d
[1, 2, [8, 10]]
```

- a[2]の値はリストなので、その要素は書き換えられる
  - `b, c, d`を作るために使ったリストのコピーは全て浅いコピー（shallow copy）
- これを解決するには、`deepcopy()`関数を使う
```python
>>> import copy
>>> a = [1, 2, [8, 9]]
>>> b = copy.deepcopy(a)
>>> a
[1, 2, [8, 9]]
>>> b
[1, 2, [8, 9]]
>>> a[2][1] = 10
>>> a
[1, 2, [8, 10]]
>>> b
[1, 2, [8, 9]]
```